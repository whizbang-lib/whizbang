<Project>
  <PropertyGroup>
    <TargetFramework>net10.0</TargetFramework>
    <LangVersion>latest</LangVersion>
    <Nullable>enable</Nullable>
    <ImplicitUsings>enable</ImplicitUsings>
    <TreatWarningsAsErrors>false</TreatWarningsAsErrors>
  </PropertyGroup>

  <!-- AOT Compatibility Settings (Production Code Only) -->
  <!-- TEMP: Excluding Whizbang.Core while completing Phases 4-5 (JSON + Dispatcher) -->
  <PropertyGroup Condition="'$(IsTestProject)' != 'true' and '$(MSBuildProjectName)' != 'Whizbang.Generators' and '$(MSBuildProjectName)' != 'Whizbang.Core'">
    <!-- Enable AOT analyzers to detect reflection and trim incompatibilities -->
    <IsAotCompatible>true</IsAotCompatible>
    <EnableAotAnalyzer>true</EnableAotAnalyzer>
    <EnableTrimAnalyzer>true</EnableTrimAnalyzer>

    <!-- Make AOT warnings errors to enforce zero reflection -->
    <!-- IL2026: RequiresUnreferencedCode usage -->
    <!-- IL2046: RequiresUnreferencedCode mismatch in implementations -->
    <!-- IL2075: DynamicallyAccessedMembers mismatch -->
    <WarningsAsErrors>$(WarningsAsErrors);IL2026;IL2046;IL2075</WarningsAsErrors>
  </PropertyGroup>

  <!-- BannedApiAnalyzers - Ban reflection attributes everywhere -->
  <ItemGroup>
    <PackageReference Include="Microsoft.CodeAnalysis.BannedApiAnalyzers" PrivateAssets="all" />
    <AdditionalFiles Include="$(MSBuildThisFileDirectory)BannedSymbols.txt" />
  </ItemGroup>

</Project>
